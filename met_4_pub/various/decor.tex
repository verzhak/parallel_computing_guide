\documentclass[10pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T2A]{fontenc}
\usepackage[english,russian]{babel}

\usepackage[pdftex]{graphicx}
\usepackage{indentfirst}
\usepackage{floatrow}
\usepackage{wrapfig}
\usepackage{pdflscape}
\usepackage{amssymb,amsfonts,amsmath}
\usepackage{tikz}
\usepackage{xspace}
\usepackage{changepage}
\usepackage{multicol}
\usepackage{multirow}
\usepackage{ltxtable}
\usepackage{fr-longtable}

%\renewcommand{\rmdefault}{ftm}

\newcolumntype{Z}{>{\centering\arraybackslash}p{3.3cm}}
\newcolumntype{L}{>{\centering\arraybackslash}p{2cm}}
\newcolumntype{N}{>{\centering\arraybackslash}p{2.4cm}}
\newcolumntype{P}{>{\centering\arraybackslash}p{3cm}}
\newcolumntype{U}{>{\centering\arraybackslash}p{2cm}}
\newcolumntype{V}{>{\centering\arraybackslash}p{8.5cm}}

\setcounter{tocdepth}{7}

\usepackage{listingsutf8}
\lstloadlanguages{C}
\lstset
{
        language = C,
		breaklines,
		columns = fullflexible,
		flexiblecolumns,
		numbers = none,
        basicstyle = \tt\fontsize{10pt}{10pt}\selectfont,
        commentstyle = ,
        showtabs = false, 
        showspaces = false,
        showstringspaces = false,
        tabsize = 2,
        inputencoding = utf8/cp1251,
		frame = single,
		showlines = true,
		resetmargins = true
}

\usepackage[a5paper]{geometry}
\geometry{left=2cm}
\geometry{right=2cm}
\geometry{top=1.5cm}
\geometry{bottom=2.5cm}

\renewcommand{\baselinestretch}{1}

\makeatletter

	\renewcommand{\@listI}
	{%
		\topsep=0pt
	}

\makeatother

\makeatletter

	\let\old@itemize=\itemize
 
	\def\itemize
	{
		\old@itemize
		\setlength{\itemsep}{0pt}
		\setlength{\parskip}{0pt}
		%\setlength{\topmargin}{0pt}
		\setlength{\leftskip}{-1em}
		\setlength{\topsep}{0pt}
		\setlength{\partopsep}{0pt}
		\setlength{\parsep}{0pt}
	}

\makeatother

\makeatletter

	\let\old@enumerate=\enumerate
 
	\def\enumerate
	{
		\old@enumerate
		\setlength{\itemsep}{0pt}
		\setlength{\parskip}{0pt}
		%\setlength{\topmargin}{0pt}
		\setlength{\leftskip}{-1em}
		\setlength{\topsep}{0pt}
		\setlength{\partopsep}{0pt}
		\setlength{\parsep}{0pt}
	}

\makeatother

\renewcommand{\theenumi}{\arabic{enumi}.}
\renewcommand{\theenumii}{\arabic{enumii}}
\renewcommand{\theenumiii}{.\arabic{enumiii}}
\renewcommand{\theenumiv}{.\arabic{enumiv}}

\renewcommand{\labelenumi}{\arabic{enumi}.}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}}
%\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}}
%\renewcommand{\labelenumiv}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.\arabic{enumiv}}

% Переопределение \caption
\makeatletter
\renewcommand{\@biblabel}[1]{#1.}
\renewcommand{\@makecaption}[2]{%
\vspace{\abovecaptionskip}%
\sbox{\@tempboxa}{#1: #2}
\ifdim \wd\@tempboxa >\hsize
   #1: #2\par
\else
   \global\@minipagefalse
   \hbox to \hsize {\hfil \small Рисунок \thefigure~<<#2>>\hfil}%
\fi
\vspace{\belowcaptionskip}}
\makeatother

\newcommand{\mysectionlab}[1]
{
	\medskip
	{\bf Лабораторная работа № \thelr. #1}
	\addcontentsline{toc}{section}{Лабораторная работа № \thelr. #1}
}

\newcommand{\mysectionvn}[1]
{
	\medskip
	{\bf #1}
	\addcontentsline{toc}{section}{#1}
}

\newcommand{\mysubsection}[1]
{
	\medskip
	{\bf #1}
}

\newcommand{\mysubsubsection}[1]
{
	\medskip
	{\bf #1}
}

\newcommand{\myparagraph}[1]
{
	\medskip
	{\bf #1}
}

\newcommand{\mysubparagraph}[1]
{
	\medskip
	{\bf #1}
}

\makeatletter 
\renewcommand\appendix
{
	\par
	\setcounter{section}{0}
	\gdef\thesection{\@Asbuk\c@section}
}
\makeatother

\newcommand\myappendix[1]
{
	\clearpage
	\refstepcounter{section}
	
	\section*{Приложение~\thesection.~#1}
	
	\addcontentsline{toc}{section}{Приложение~\thesection.~#1}
}

\newcommand{\mysource}[3]
{
	\refstepcounter{lstcon}
	\label{listing:#2}
	{
		\lstinputlisting[]{#1}
		\nopagebreak
		
		\vbox{\small \centering Листинг~\thelstcon~---~#3}
		\bigskip
	}
}

% Листинги внутри локумента
%
% \mylistingbegin{Метка в listing:}{Подпись}
% \begin{lstlisting}
% \end{lstlisting}
% \mylistingend
%

\newcommand{\mylistingcaption}{}
\newcommand{\mylistinglabel}{}

\newcommand{\mylistingbegin}[2]
{
	\refstepcounter{lstcon}
	\renewcommand{\mylistingcaption}{\vbox{\small \centering Листинг~\thelstcon~---~#2}}
	\renewcommand{\mylistinglabel}{\label{listing:#1}}
	\begin{adjustwidth}{-\leftmargin}{\rightmargin}
}

\newcommand{\mylistingend}
{
	\mylistingcaption
	\mylistinglabel
	\end{adjustwidth}
	\medskip
}

\newcommand{\mimage}[4]
{
	\vbox
	{
		\begin{center}

			\refstepcounter{figure}
			\label{image:#1}
			
			\includegraphics[#4]{image/#2}

			\medskip
			{\noindent \small Рисунок~\thefigure~---~#3}

		\end{center}
	}
}

\renewcommand{\thefigure}{\arabic{figure}}
\setcounter{figure}{0}

\newcounter{lstcon}
\setcounter{lstcon}{0}

\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\theenumii}{\arabic{enumii}}
\renewcommand{\theenumiii}{\arabic{enumiii}}
\renewcommand{\labelenumi}{\arabic{enumi})}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii})}
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii})}
% \renewcommand{\labelenumi}{\asbuk{enumi})} % ГОСТы
% \renewcommand{\labelenumii}{\arabic{enumii})}

\renewcommand{\labelitemi}{$-$}
\renewcommand{\labelitemii}{$-$}

\makeatletter
\def\tableofcontents{\mysectionvn{Содержание}\@starttoc{toc}}
\makeatother

\makeatletter
\renewcommand{\@biblabel}[1]{#1.}
\makeatother

\newcommand{\gl}{ОС GNU/Linux\xspace}

