
OUTPUT_DIR = build
FNAME = demo
RELEASE_OUTPUT_FNAME = $(OUTPUT_DIR)/$(FNAME)
RELEASE_OUTPUT_FNAME_CRITICAL = $(OUTPUT_DIR)/$(FNAME)_critical
DEBUG_OUTPUT_FNAME = $(RELEASE_OUTPUT_FNAME)_debug
DEBUG_OUTPUT_FNAME_CRITICAL = $(RELEASE_OUTPUT_FNAME_CRITICAL)_debug

SRC = main.c
SRC_CRITICAL = main_critical.c

FLAGS = -pipe -Wall -fopenmp
FLAGS_DEBUG = -g
FLAGS_RELEASE = -O2

INCLUDE =
LIB = -lm -lrt -lOpenCL

debug: clean

	mkdir -p $(OUTPUT_DIR)/
	gcc $(FLAGS) $(FLAGS_DEBUG) $(LIB) $(INCLUDE) $(SRC) -o $(DEBUG_OUTPUT_FNAME)
	gcc $(FLAGS) $(FLAGS_DEBUG) $(LIB) $(INCLUDE) $(SRC_CRITICAL) -o $(DEBUG_OUTPUT_FNAME_CRITICAL)

release:

	mkdir -p $(OUTPUT_DIR)/
	gcc $(FLAGS) $(FLAGS_RELEASE) $(LIB) $(INCLUDE) $(SRC) -o $(RELEASE_OUTPUT_FNAME)
	gcc $(FLAGS) $(FLAGS_RELEASE) $(LIB) $(INCLUDE) $(SRC_CRITICAL) -o $(RELEASE_OUTPUT_FNAME_CRITICAL)

clean:

	rm -f $(OUTPUT_DIR)/*

distclean:

	rm -Rf $(OUTPUT_DIR)

